#!/bin/bash

control=$1
files=$2
database=$3
ram=$4
date=`date`

lxc-stop -n "$control"
lxc-stop -n "$files"
lxc-stop -n "$database"
lxc-stop -n "$ram"
lxc-destroy -n "$control"
lxc-destroy -n "$files"
lxc-destroy -n "$database"
lxc-destroy -n "$ram"
echo "All containers have been destroyed on $date" >> recycling_results.txt

sleep 10

#Source containers should be stopped
lxc-copy -n "control_template" -N "$control"
lxc-copy -n "files_template" -N "$files"
lxc-copy -n "database_template" -N "$database"
lxc-copy -n "ram_copy" -N "$ram"
echo "All containers have been copied with their corresponding template on $date" >> recycling_results.txt

lxc-start -n "$control"
lxc-start -n "$files"
lxc-start -n "$database"
lxc-start -n "$ram"
echo "All containers have been started on $date" >> recycling_results.txt

